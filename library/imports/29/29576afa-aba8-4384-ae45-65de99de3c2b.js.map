{"version":3,"sources":["../../../../../../assets/script/wx/rank/assets/script/wx/rank/rankLayer.js"],"names":["rank","require","config","self","cc","Class","extends","Component","properties","tongle1","default","type","Toggle","tongle2","listItem","Prefab","onLoad","_friendsData","Array","_worldsData","_friendsBests","_worldsBests","_weekRankTitle","find","node","getComponent","Label","_myRank","_scroll2","_content2","_c2","_cc2","_scroll1","_content1","_c1","_cc1","_initLoopScrollView1","_initLoopScrollView2","_checkToggle1","_rankShowWidget","i","index","register","maskTouch","event","cusData","stopPropagation","qunRankBtn","parent","js","shareTicket","active","getOpenDataQunRankBtn","shareBtn","backbtn","on","_callBack","start","createItem","info","_item","instantiate","itemJs","init","res","callbacks","isWeek","console","log","string","splice","length","friendRank","worldRank","myRank","myRnakWidget","initBestsData","_resetLoopScrollView","_checkNum","check","value","shift","value2","score","push","_initBestsView","list","_initBest","path","_rank","name","grade","location","image","Sprite","city","texture","portrait","split","loader","load","url","err","spriteFrame","SpriteFrame","setTexture","_scroll","num","data","registerCreateItemFunc","itemNode","registerUpdateItemFunc","cell","setTotalNum","resetView","checkTongle1","checkTongle2"],"mappings":";;;;;;AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAIA,OAAOC,QAAQ,QAAR,CAAX;AACA,IAAIC,SAASD,QAAQ,QAAR,CAAb;AACA,IAAIE,OAAO,IAAX;AACAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAC,iBAAQ;AACJC,qBAAQ,IADJ;AAEJC,kBAAKP,GAAGQ;AAFJ,SAhBA;AAoBRC,iBAAQ;AACJH,qBAAQ,IADJ;AAEJC,kBAAKP,GAAGQ;AAFJ,SApBA;AAwBRE,kBAAU;AACNJ,qBAAQ,IADF;AAENC,kBAAKP,GAAGW;AAFF;AAxBF,KAHP;;AAiCL;;AAEAC,UAnCK,oBAmCK;AACNb,eAAO,IAAP;AACAA,aAAKc,YAAL,GAAoB,IAAIC,KAAJ,EAApB;AACAf,aAAKgB,WAAL,GAAmB,IAAID,KAAJ,EAAnB;AACAf,aAAKiB,aAAL,GAAqB,IAAIF,KAAJ,EAArB;AACAf,aAAKkB,YAAL,GAAoB,IAAIH,KAAJ,EAApB;;AAEAf,aAAKmB,cAAL,GAAsBlB,GAAGmB,IAAH,CAAQ,WAAR,EAAoBpB,KAAKqB,IAAzB,EAA+BC,YAA/B,CAA4CrB,GAAGsB,KAA/C,CAAtB;AACAvB,aAAKwB,OAAL,GAAe,CAAf;AACAxB,aAAKyB,QAAL,GAAgBxB,GAAGmB,IAAH,CAAQ,aAAR,EAAsBpB,KAAKqB,IAA3B,CAAhB;AACArB,aAAK0B,SAAL,GAAiB1B,KAAKyB,QAAL,CAAcH,YAAd,CAA2B,kBAA3B,CAAjB;AACAtB,aAAK2B,GAAL,GAAW1B,GAAGmB,IAAH,CAAQ,8BAAR,EAAuCpB,KAAKqB,IAA5C,CAAX;AACArB,aAAK4B,IAAL,GAAY3B,GAAGmB,IAAH,CAAQ,sBAAR,EAA+BpB,KAAKqB,IAApC,CAAZ;AACArB,aAAK6B,QAAL,GAAgB5B,GAAGmB,IAAH,CAAQ,YAAR,EAAqBpB,KAAKqB,IAA1B,CAAhB;AACArB,aAAK8B,SAAL,GAAiB9B,KAAK6B,QAAL,CAAcP,YAAd,CAA2B,kBAA3B,CAAjB;AACAtB,aAAK+B,GAAL,GAAW9B,GAAGmB,IAAH,CAAQ,6BAAR,EAAsCpB,KAAKqB,IAA3C,CAAX;AACArB,aAAKgC,IAAL,GAAY/B,GAAGmB,IAAH,CAAQ,qBAAR,EAA8BpB,KAAKqB,IAAnC,CAAZ;AACArB,aAAKiC,oBAAL,CAA0BjC,KAAK8B,SAA/B;AACA9B,aAAKkC,oBAAL,CAA0BlC,KAAK0B,SAA/B;;AAEA1B,aAAKmC,aAAL,GAAqBlC,GAAGmB,IAAH,CAAQ,mBAAR,EAA4BpB,KAAKqB,IAAjC,EAAuCC,YAAvC,CAAoDrB,GAAGQ,MAAvD,CAArB;AACAT,aAAKoC,eAAL,GAAuB,IAAIrB,KAAJ,EAAvB;AACA,aAAI,IAAIsB,IAAI,CAAZ,EAAeA,IAAI,CAAnB,EAAuBA,GAAvB,EAA2B;AACvB,gBAAIC,QAAQD,IAAE,CAAd;AACArC,iBAAKoC,eAAL,CAAqBC,CAArB,IAA0BpC,GAAGmB,IAAH,CAAQ,cAAYkB,KAApB,EAA0BtC,KAAKqB,IAA/B,CAA1B;AACH;AACDrB,aAAKuC,QAAL;AACH,KA9DI;;AA+DL;AACAC,aAhEK,qBAgEKC,KAhEL,EAgEWC,OAhEX,EAgEmB;AACpB,YAAGD,KAAH,EAAS;AACLA,kBAAME,eAAN;AACH;AACJ,KApEI;AAsELC,cAtEK,wBAsEO;;AAER,YAAIC,SAAS7C,KAAKqB,IAAL,CAAUwB,MAAvB;AACA,YAAIC,KAAKD,OAAOvB,YAAP,CAAoB,YAApB,CAAT;AACA,YAAG,CAAC,CAAC,CAACwB,EAAN,EAAS;AACL;AACH;AACD,YAAG/C,OAAOgD,WAAV,EAAsB;AAClB/C,iBAAKqB,IAAL,CAAU2B,MAAV,GAAmB,KAAnB;AACAF,eAAGG,qBAAH;AAEH,SAJD,MAIK;AACDH,eAAGI,QAAH;AACH;AAEJ,KArFI;AAuFLX,YAvFK,sBAuFK;AACN,YAAIY,UAAUlD,GAAGmB,IAAH,CAAQ,aAAR,EAAsBpB,KAAKqB,IAA3B,CAAd;AACA8B,gBAAQC,EAAR,CAAW,OAAX,EAAmB,UAASX,KAAT,EAAe;AAC9B,gBAAGzC,KAAKqD,SAAR,EAAkB;AACdrD,qBAAKqD,SAAL;AACH;AACDrD,iBAAKqB,IAAL,CAAU2B,MAAV,GAAmB,KAAnB;AACH,SALD,EAKEhD,IALF;AAMH,KA/FI;AAgGLsD,SAhGK,mBAgGI,CAER,CAlGI;AAmGLC,cAnGK,sBAmGMlB,CAnGN,EAmGQmB,IAnGR,EAmGa;AACd,YAAIC,QAAQxD,GAAGyD,WAAH,CAAe1D,KAAKW,QAApB,CAAZ;AACA,YAAIgD,SAASF,MAAMnC,YAAN,CAAmB,MAAnB,CAAb;AACAqC,eAAOC,IAAP,CAAYJ,IAAZ,EAAiBnB,CAAjB;AACA,eAAOoB,KAAP;AACH,KAxGI;AAyGLG,QAzGK,gBAyGAC,GAzGA,EAyGIC,SAzGJ,EAyGcC,MAzGd,EAyGqB;AACtBC,gBAAQC,GAAR,CAAY,WAAZ,EAAwBJ,GAAxB;AACA,YAAGE,MAAH,EAAU;AACN/D,iBAAKmB,cAAL,CAAoB+C,MAApB,GAA6B,MAA7B;AACH,SAFD,MAEK;AACDlE,iBAAKmB,cAAL,CAAoB+C,MAApB,GAA6B,MAA7B;AACH;AACDlE,aAAKc,YAAL,CAAkBqD,MAAlB,CAAyB,CAAzB,EAA2BnE,KAAKc,YAAL,CAAkBsD,MAA7C;AACApE,aAAKgB,WAAL,CAAiBmD,MAAjB,CAAwB,CAAxB,EAA0BnE,KAAKgB,WAAL,CAAiBoD,MAA3C;AACA;AACApE,aAAKc,YAAL,GAAoB+C,IAAIQ,UAAxB;AACArE,aAAKgB,WAAL,GAAmB6C,IAAIS,SAAvB;AACA;AACA;AACA;AACA;AACAtE,aAAKwB,OAAL,GAAeqC,IAAIU,MAAnB;AACAvE,aAAKqD,SAAL,GAAiBS,SAAjB;;AAEA;AACA,YAAIU,eAAevE,GAAGmB,IAAH,CAAQ,iBAAR,EAA0BpB,KAAKqB,IAA/B,CAAnB;AACA,YAAGrB,KAAKwB,OAAR,EAAgB;AACZgD,yBAAalD,YAAb,CAA0BrB,GAAGsB,KAA7B,EAAoC2C,MAApC,GAA6C,UAASlE,KAAKwB,OAA3D;AACH,SAFD,MAEK;AACDgD,yBAAalD,YAAb,CAA0BrB,GAAGsB,KAA7B,EAAoC2C,MAApC,GAA6C,UAA7C;AACH;;AAEDlE,aAAKyE,aAAL;AACCzE,aAAK0E,oBAAL,CAA0B1E,KAAK8B,SAA/B,EAAyC9B,KAAKc,YAAL,CAAkBsD,MAA3D;AACD;AACA;AACA;AACApE,aAAKyB,QAAL,CAAcuB,MAAd,GAAuB,KAAvB;AACAhD,aAAK2E,SAAL,GAAiB,CAAjB;AACA3E,aAAKmC,aAAL,CAAmByC,KAAnB;AAEH,KA7II;AA8ILH,iBA9IK,2BA+IL;AACIzE,aAAKiB,aAAL,CAAmBkD,MAAnB,CAA0B,CAA1B,EAA4BnE,KAAKiB,aAAL,CAAmBmD,MAA/C;AACApE,aAAKkB,YAAL,CAAkBiD,MAAlB,CAAyB,CAAzB,EAA2BnE,KAAKkB,YAAL,CAAkBkD,MAA7C;AACA,aAAI,IAAI/B,IAAI,CAAZ,EAAeA,IAAI,CAAnB,EAAuBA,GAAvB,EAA2B;AACvB,gBAAIwC,QAAQ7E,KAAKc,YAAL,CAAkBgE,KAAlB,EAAZ;AACA,gBAAIC,SAAS/E,KAAKgB,WAAL,CAAiB8D,KAAjB,EAAb;AACA,gBAAG,OAAOD,KAAP,IAAgB,WAAnB,EAA+B;AAC3B,oBAAGA,MAAM,OAAN,KAAkBA,MAAMG,KAAN,IAAe,CAApC,EAAsC;AAClChF,yBAAKiB,aAAL,CAAmBgE,IAAnB,CAAwBJ,KAAxB;AACH;AACJ;AACD,gBAAG,OAAOE,MAAP,IAAiB,WAApB,EAAgC;AAC5B,oBAAGA,OAAO,OAAP,KAAmBA,OAAOC,KAAP,IAAgB,CAAtC,EAAwC;AACpChF,yBAAKkB,YAAL,CAAkB+D,IAAlB,CAAuBF,MAAvB;AACH;AACJ;AACJ;AACD/E,aAAKkF,cAAL,CAAoBlF,KAAKiB,aAAzB;AACH,KAjKI;AAkKLiE,kBAlKK,0BAkKUC,IAlKV,EAkKe;AAChB,aAAI,IAAI9C,IAAI,CAAZ,EAAeA,IAAI,CAAnB,EAAuBA,GAAvB,EAA2B;AACvB,gBAAIwC,QAAQM,KAAK9C,CAAL,CAAZ;AACA,gBAAG,OAAOwC,KAAP,IAAgB,WAAnB,EAA+B;AAC3B7E,qBAAKoF,SAAL,CAAe/C,IAAG,CAAlB,EAAoBwC,KAApB;AACA7E,qBAAKoC,eAAL,CAAqBC,CAArB,EAAwBW,MAAxB,GAAiC,IAAjC;AACH,aAHD,MAGK;AACDhD,qBAAKoC,eAAL,CAAqBC,CAArB,EAAwBW,MAAxB,GAAiC,KAAjC;AACH;AACJ;AACJ,KA5KI;AA6KLoC,aA7KK,qBA6KK9C,KA7KL,EA6KYuC,KA7KZ,EA6KkB;AACnB,YAAIQ,OAAO,cAAY/C,KAAvB;AACA;AACA,YAAIgD,QAAQrF,GAAGmB,IAAH,CAAQiE,IAAR,EAAarF,KAAKqB,IAAlB,CAAZ;AACA,YAAIkE,OAAOtF,GAAGmB,IAAH,CAAQ,MAAR,EAAekE,KAAf,CAAX;AACAC,eAAOA,KAAKjE,YAAL,CAAkBrB,GAAGsB,KAArB,CAAP;AACA,YAAIiE,QAAQvF,GAAGmB,IAAH,CAAQ,YAAR,EAAqBkE,KAArB,CAAZ;AACAE,gBAAQA,MAAMlE,YAAN,CAAmBrB,GAAGsB,KAAtB,CAAR;AACA,YAAIkE,WAAWxF,GAAGmB,IAAH,CAAQ,UAAR,EAAmBkE,KAAnB,CAAf;AACAG,mBAAWA,SAASnE,YAAT,CAAsBrB,GAAGsB,KAAzB,CAAX;AACA,YAAImE,QAAQzF,GAAGmB,IAAH,CAAQ,YAAR,EAAqBkE,KAArB,CAAZ;AACAI,gBAAQA,MAAMpE,YAAN,CAAmBrB,GAAG0F,MAAtB,CAAR;;AAEAJ,aAAKrB,MAAL,GAAcW,MAAMU,IAAN,IAAc,EAA5B;AACAC,cAAMtB,MAAN,GAAeW,MAAMG,KAAN,IAAe,CAA9B;AACA,YAAGH,MAAM,MAAN,CAAH,EAAiB;AACbY,qBAASvB,MAAT,GAAkB,QAAMW,MAAMe,IAA9B;AACH;AACD;AACA,YAAIC,UAAUhB,MAAMiB,QAApB;AACA,YAAI,CAACD,OAAL,EAAa;AACT;AACH;AACDA,kBAAUA,QAAQE,KAAR,CAAc,IAAd,EAAmB,CAAnB,CAAV;AACAF,kBAAUA,UAAU,KAApB;AACA5F,WAAG+F,MAAH,CAAUC,IAAV,CAAe,EAACC,KAAIL,OAAL,EAAcrF,MAAK,KAAnB,EAAf,EAAyC,UAAS2F,GAAT,EAAaN,OAAb,EAAqB;AAC1D,gBAAIO,cAAc,IAAInG,GAAGoG,WAAP,EAAlB;AACAD,wBAAYE,UAAZ,CAAuBT,OAAvB;AACAH,kBAAMU,WAAN,GAAoBA,WAApB;AAEH,SALD;AAOH,KA7MI;AA8MLnE,wBA9MK,gCA8MgBsE,OA9MhB,EA8MwBC,GA9MxB,EA8M4BC,IA9M5B,EA8MiC;;AAElCF,gBAAQG,sBAAR,CAA+B,YAAU;AACrC,gBAAIC,WAAW1G,GAAGyD,WAAH,CAAe1D,KAAKW,QAApB,CAAf;AACA,mBAAOgG,QAAP;AACH,SAHD;AAIAJ,gBAAQK,sBAAR,CAA+B,UAASC,IAAT,EAAcvE,KAAd,EAAoB;AAC/C,gBAAIQ,KAAK+D,KAAKvF,YAAL,CAAkB,MAAlB,CAAT;AACAwB,eAAGc,IAAH,CAAQ5D,KAAKc,YAAL,CAAkBwB,KAAlB,CAAR,EAAiCA,KAAjC;AACH,SAHD;AAKH,KAzNI;AA0NLoC,wBA1NK,gCA0NgB6B,OA1NhB,EA0NwBC,GA1NxB,EA0N4B;AAC7B;AACAD,gBAAQO,WAAR,CAAoBN,GAApB;AACAD,gBAAQQ,SAAR;AACH,KA9NI;AA+NL7E,wBA/NK,gCA+NgBqE,OA/NhB,EA+NwBC,GA/NxB,EA+N4BC,IA/N5B,EA+NiC;;AAElCF,gBAAQG,sBAAR,CAA+B,YAAU;AACrC,gBAAIC,WAAW1G,GAAGyD,WAAH,CAAe1D,KAAKW,QAApB,CAAf;AACA,mBAAOgG,QAAP;AACH,SAHD;AAIAJ,gBAAQK,sBAAR,CAA+B,UAASC,IAAT,EAAcvE,KAAd,EAAoB;;AAE/C,gBAAIQ,KAAK+D,KAAKvF,YAAL,CAAkB,MAAlB,CAAT;AACAwB,eAAGc,IAAH,CAAQ5D,KAAKgB,WAAL,CAAiBsB,KAAjB,CAAR,EAAgCA,KAAhC;AACH,SAJD;AAMH,KA3OI;;;AA6OL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA0E,gBA/PK,0BA+PS;AACVhD,gBAAQC,GAAR,CAAY,QAAZ;;AAEAjE,aAAKkF,cAAL,CAAoBlF,KAAKiB,aAAzB;AACAjB,aAAK6B,QAAL,CAAcmB,MAAd,GAAuB,IAAvB;AACAhD,aAAKyB,QAAL,CAAcuB,MAAd,GAAuB,KAAvB;AACAhD,aAAK+B,GAAL,CAASiB,MAAT,GAAkB,IAAlB;AACAhD,aAAKgC,IAAL,CAAUgB,MAAV,GAAkB,IAAlB;AACA;AACA;AACA;AACA;AACA;AAEH,KA7QI;AA8QLiE,gBA9QK,0BA8QS;AACVjD,gBAAQC,GAAR,CAAY,QAAZ;AACAjE,aAAKkF,cAAL,CAAoBlF,KAAKkB,YAAzB;AACAlB,aAAK6B,QAAL,CAAcmB,MAAd,GAAuB,KAAvB;AACAhD,aAAKyB,QAAL,CAAcuB,MAAd,GAAuB,IAAvB;AACAhD,aAAK2B,GAAL,CAASqB,MAAT,GAAkB,IAAlB;AACAhD,aAAK4B,IAAL,CAAUoB,MAAV,GAAkB,IAAlB;AACAhD,aAAK2E,SAAL;AACA,YAAG3E,KAAK2E,SAAL,IAAiB,CAApB,EACA;AACI3E,iBAAK0E,oBAAL,CAA0B1E,KAAK0B,SAA/B,EAAyC1B,KAAKgB,WAAL,CAAiBoD,MAA1D;AACH;AAGJ;AACD;;AA7RK,CAAT","file":"rankLayer.js","sourceRoot":"../../../../../../assets/script/wx/rank","sourcesContent":["//import { text } from './C:/Users/wu/AppData/Local/Microsoft/TypeScript/2.6/node_modules/@types/body-parser';\r\n\r\n// Learn cc.Class:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\r\nvar rank = require('./rank');\r\nvar config = require('config');\r\nvar self = null;\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n        tongle1:{\r\n            default:null,\r\n            type:cc.Toggle,\r\n        },\r\n        tongle2:{\r\n            default:null,\r\n            type:cc.Toggle,\r\n        },\r\n        listItem :{\r\n            default:null,\r\n            type:cc.Prefab,\r\n        },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        self = this;\r\n        self._friendsData = new Array();\r\n        self._worldsData = new Array();\r\n        self._friendsBests = new Array();\r\n        self._worldsBests = new Array();\r\n\r\n        self._weekRankTitle = cc.find('top/Title',self.node).getComponent(cc.Label);\r\n        self._myRank = 0;\r\n        self._scroll2 = cc.find(\"rankScroll2\",self.node);\r\n        self._content2 = self._scroll2.getComponent('uiloopscrollview');\r\n        self._c2 = cc.find(\"rankScroll2/viewport/content\",self.node);\r\n        self._cc2 = cc.find(\"rankScroll2/viewport\",self.node);\r\n        self._scroll1 = cc.find(\"rankScroll\",self.node);\r\n        self._content1 = self._scroll1.getComponent('uiloopscrollview');\r\n        self._c1 = cc.find(\"rankScroll/viewport/content\",self.node);\r\n        self._cc1 = cc.find(\"rankScroll/viewport\",self.node);\r\n        self._initLoopScrollView1(self._content1);\r\n        self._initLoopScrollView2(self._content2);\r\n\r\n        self._checkToggle1 = cc.find(\"top/check/toggle1\",self.node).getComponent(cc.Toggle);\r\n        self._rankShowWidget = new Array();\r\n        for(var i = 0; i < 3 ; i++){\r\n            var index = i+1;\r\n            self._rankShowWidget[i] = cc.find(\"top/rank_\"+index,self.node);\r\n        }\r\n        self.register()\r\n    },\r\n    //终止 touch 传递\r\n    maskTouch(event,cusData){\r\n        if(event){\r\n            event.stopPropagation();\r\n        }\r\n    },\r\n\r\n    qunRankBtn(){\r\n        \r\n        var parent = self.node.parent;\r\n        var js = parent.getComponent('wxAddLayer');\r\n        if(!!!js){\r\n            return;   \r\n        }\r\n        if(config.shareTicket){ \r\n            self.node.active = false;\r\n            js.getOpenDataQunRankBtn();\r\n\r\n        }else{\r\n            js.shareBtn();          \r\n        }\r\n       \r\n    },\r\n\r\n    register(){\r\n        var backbtn = cc.find(\"top/backBtn\",self.node);\r\n        backbtn.on('click',function(event){\r\n            if(self._callBack){\r\n                self._callBack()\r\n            }\r\n            self.node.active = false;\r\n        },self)\r\n    },\r\n    start () {\r\n\r\n    },\r\n    createItem(i,info){\r\n        var _item = cc.instantiate(self.listItem);\r\n        var itemJs = _item.getComponent('item')\r\n        itemJs.init(info,i);\r\n        return _item ;\r\n    },\r\n    init(res,callbacks,isWeek){\r\n        console.log(\"rankLayer\",res);\r\n        if(isWeek){\r\n            self._weekRankTitle.string = '周排行榜'\r\n        }else{\r\n            self._weekRankTitle.string = '周排行榜' \r\n        }\r\n        self._friendsData.splice(0,self._friendsData.length);\r\n        self._worldsData.splice(0,self._worldsData.length);\r\n        //console.log(\"inittas\",res.friendRank,res.worldRank)\r\n        self._friendsData = res.friendRank;\r\n        self._worldsData = res.worldRank;\r\n        // for(var i = 0; i< 100; i++){\r\n        //     self._friendsData[i] = res.friendRank[0];\r\n        //     self._worldsData[i] = res.worldRank[0];\r\n        // }\r\n        self._myRank = res.myRank;\r\n        self._callBack = callbacks;\r\n\r\n        //我的排名\r\n        var myRnakWidget = cc.find(\"myRankBg/myRank\",self.node)\r\n        if(self._myRank){\r\n            myRnakWidget.getComponent(cc.Label).string = \"我的排名：\"+ self._myRank;\r\n        }else{\r\n            myRnakWidget.getComponent(cc.Label).string = \"我的排名：未上榜\";    \r\n        }\r\n        \r\n        self.initBestsData();\r\n         self._resetLoopScrollView(self._content1,self._friendsData.length);\r\n        // console.log(\"self._friendsData.length\",self._friendsData.length,self._scroll1.active);\r\n        // self._resetLoopScrollView(self._content2,self._worldsData.length);\r\n        // console.log(\"self._worldsData.length\",self._worldsData.length,self._scroll2.active)\r\n        self._scroll2.active = false;\r\n        self._checkNum = 0;\r\n        self._checkToggle1.check();\r\n        \r\n    },\r\n    initBestsData()\r\n    {\r\n        self._friendsBests.splice(0,self._friendsBests.length)\r\n        self._worldsBests.splice(0,self._worldsBests.length)\r\n        for(let i = 0; i < 3 ; i++){\r\n            let value = self._friendsData.shift();\r\n            let value2 = self._worldsData.shift();\r\n            if(typeof(value) !=\"undefined\"){ \r\n                if(value[\"score\"] && value.score != 0){\r\n                    self._friendsBests.push(value)  \r\n                }    \r\n            }\r\n            if(typeof(value2) !=\"undefined\"){ \r\n                if(value2[\"score\"] && value2.score != 0){\r\n                    self._worldsBests.push(value2)   \r\n                }      \r\n            }\r\n        }\r\n        self._initBestsView(self._friendsBests)\r\n    },\r\n    _initBestsView(list){\r\n        for(let i = 0; i < 3 ; i++){\r\n            var value = list[i];\r\n            if(typeof(value) !=\"undefined\"){ \r\n                self._initBest(i +1,value);\r\n                self._rankShowWidget[i].active = true;\r\n            }else{\r\n                self._rankShowWidget[i].active = false ;            \r\n            }\r\n        }      \r\n    },\r\n    _initBest(index, value){\r\n        var path = \"top/rank_\"+index\r\n        //这些都无用\r\n        var _rank = cc.find(path,self.node);\r\n        var name = cc.find(\"name\",_rank);\r\n        name = name.getComponent(cc.Label)\r\n        var grade = cc.find(\"star/grade\",_rank);\r\n        grade = grade.getComponent(cc.Label)\r\n        var location = cc.find(\"location\",_rank);\r\n        location = location.getComponent(cc.Label)\r\n        var image = cc.find(\"mask/image\",_rank);\r\n        image = image.getComponent(cc.Sprite)\r\n\r\n        name.string = value.name || \"\";\r\n        grade.string = value.score || 0 ;\r\n        if(value[\"city\"]){\r\n            location.string = '地区:'+value.city;\r\n        }\r\n        //获取人物头像\r\n        var texture = value.portrait;\r\n        if (!texture){\r\n            return\r\n        }\r\n        texture = texture.split(\"/0\",1); \r\n        texture = texture + \"/64\";\r\n        cc.loader.load({url:texture, type:'png'},function(err,texture){\r\n            var spriteFrame = new cc.SpriteFrame();\r\n            spriteFrame.setTexture(texture)\r\n            image.spriteFrame = spriteFrame\r\n\r\n        })\r\n\r\n    },\r\n    _initLoopScrollView1(_scroll,num,data){\r\n       \r\n        _scroll.registerCreateItemFunc(function(){\r\n            var itemNode = cc.instantiate(self.listItem);\r\n            return itemNode;\r\n        });\r\n        _scroll.registerUpdateItemFunc(function(cell,index){\r\n            var js = cell.getComponent('item');\r\n            js.init(self._friendsData[index],index);\r\n        });\r\n\r\n    },\r\n    _resetLoopScrollView(_scroll,num){\r\n        //_scroll.moveToFront(0.1);\r\n        _scroll.setTotalNum(num);\r\n        _scroll.resetView();\r\n    },\r\n    _initLoopScrollView2(_scroll,num,data){\r\n       \r\n        _scroll.registerCreateItemFunc(function(){\r\n            var itemNode = cc.instantiate(self.listItem);\r\n            return itemNode;\r\n        });\r\n        _scroll.registerUpdateItemFunc(function(cell,index){\r\n\r\n            var js = cell.getComponent('item');\r\n            js.init(self._worldsData[index],index);\r\n        });\r\n\r\n    },\r\n\r\n    // _initScroll(_scroll, num, data){\r\n    //     var _height = 0\r\n    //     var content = _scroll\r\n        \r\n    //     for(let i = 0 ; i < num;i ++){\r\n    //         var item = self.createItem(i,data[i])       \r\n    //         content.addChild(item)\r\n    //         if (_height === 0){\r\n    //             _height = item.getContentSize().height\r\n    //         }\r\n    //         item.setPosition(0,- i * _height - _height/2)\r\n\r\n    //     };\r\n    //     var contentSize = content.getContentSize()\r\n    //     if (_height*num > contentSize.height){\r\n    //         content.setContentSize (contentSize.width, _height*num)\r\n    //     }\r\n    // },\r\n    checkTongle1(){\r\n        console.log(\"check1\")\r\n\r\n        self._initBestsView(self._friendsBests);\r\n        self._scroll1.active = true;\r\n        self._scroll2.active = false;\r\n        self._c1.active = true; \r\n        self._cc1.active =true;   \r\n        // if(self._checkNum< 2)         \r\n        // {\r\n        //     self._resetLoopScrollView(self._content1,self._friendsData.length); \r\n        // }\r\n        // self._checkNum ++; \r\n        \r\n    },\r\n    checkTongle2(){\r\n        console.log(\"check2\")\r\n        self._initBestsView(self._worldsBests) \r\n        self._scroll1.active = false;\r\n        self._scroll2.active = true;\r\n        self._c2.active = true;\r\n        self._cc2.active =true;\r\n        self._checkNum ++;\r\n        if(self._checkNum<= 1)         \r\n        {\r\n            self._resetLoopScrollView(self._content2,self._worldsData.length); \r\n        }\r\n         \r\n        \r\n    }\r\n    // update (dt) {},\r\n});\r\n"]}