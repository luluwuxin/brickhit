{"version":3,"sources":["../../../../../../assets/script/wx/myAssist/assets/script/wx/myAssist/myAssistLayer.js"],"names":["global","require","self","cc","Class","extends","Component","properties","gold","Label","timesNode","Node","textsTwo","btn","btnTwo","textures","SpriteFrame","reviveTwo","goldText","onLoad","_times","timesLabel","getComponent","timesTwoLabel","init","callBack","flag","consumeGold","_flag","active","string","_consumeGold","_callBack","parent","node","js","_js","getGold","closeBtn","goldCallBackBtn","flyText","color","subGold","assistBtn","Sprite","spriteFrame","shareBtnWithAssit","getTimestamp","schedule","mainTime","showMeReq","_tt","_T","Math","ceil","unschedule","start"],"mappings":"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","file":"myAssistLayer.js","sourceRoot":"../../../../../../assets/script/wx/myAssist","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\nvar global = require(\"global\");\r\nvar self = null;\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return self._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         self._bar = value;\r\n        //     }\r\n        // },\r\n        gold:cc.Label,\r\n        timesNode:cc.Node,\r\n        textsTwo:cc.Node,\r\n        btn:cc.Node,\r\n        btnTwo:cc.Node,\r\n        textures:[cc.SpriteFrame],\r\n        reviveTwo:cc.Node,\r\n        goldText:cc.Label,\r\n        \r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        self = this;\r\n        self._times = 0;\r\n        self.timesLabel = self.timesNode.getComponent(cc.Label);\r\n        self.timesTwoLabel = self.textsTwo.getComponent(cc.Label);\r\n    },\r\n\r\n    init(callBack,flag = false,consumeGold){\r\n        self._flag = flag;\r\n        if(self._flag){\r\n            self.reviveTwo.active = true;\r\n            self.btn.active = false;\r\n            self.goldText.string = 'x' + consumeGold;\r\n        }else{\r\n            self.btn.active = true;\r\n            self.reviveTwo.active = false\r\n        }\r\n        self._consumeGold = consumeGold;\r\n        self._callBack = callBack;\r\n        var parent = self.node.parent;\r\n        var js = parent.getComponent('wxAddLayer');\r\n        if(!!!js){\r\n            return;   \r\n        }\r\n        self._js = js;\r\n        self.gold.string = js.getGold();\r\n    },\r\n    closeBtn(){\r\n        \r\n        //self.timesNode.active = false;\r\n        self.node.active = false;\r\n    },\r\n    goldCallBackBtn(){\r\n        if(self._js.getGold() < self._consumeGold){\r\n            global.flyText(self.node,\"金币不足，请邀请互助获取\",cc.color(255,255,255),cc.color(0,0,0),2)\r\n        }else{\r\n            if(self._callBack){\r\n                self.closeBtn();\r\n                self._js.subGold(self._consumeGold);\r\n                self._callBack();\r\n            }\r\n        }\r\n    },\r\n    assistBtn(){\r\n        if(!!! self.timesNode.active ){\r\n            var parent = self.node.parent;\r\n\r\n            self.btnTwo.getComponent(cc.Sprite).spriteFrame = self.textures[0];\r\n            self.btn.getComponent(cc.Sprite).spriteFrame = self.textures[0];\r\n            \r\n            \r\n            var js = parent.getComponent('wxAddLayer');\r\n            if(!!!js){\r\n                return;   \r\n            }\r\n            js.shareBtnWithAssit(null,function(){\r\n                self.timesNode.active = true;\r\n                self.btnTwo.getComponent(cc.Sprite).spriteFrame = self.textures[1];\r\n                self.btn.getComponent(cc.Sprite).spriteFrame = self.textures[1];\r\n                \r\n                self._times = global.getTimestamp() + 60;\r\n                self.schedule(self.mainTime,1);\r\n                js.showMeReq()\r\n            });\r\n        }else{\r\n            global.flyText(self.node,\"正在收集小伙伴的助力灵气\",cc.color(255,255,255),cc.color(0,0,0),2)\r\n        }\r\n\r\n        \r\n    },\r\n    mainTime(){\r\n        self.timesNode.active = true;\r\n        self.textsTwo.active = true;\r\n        let _tt = global.getTimestamp();\r\n        let _T = Math.ceil( self._times - _tt);\r\n        self.timesLabel.string = _T;\r\n        self.timesTwoLabel.string = _T;\r\n        if(_T <= 0){\r\n            self.timesNode.active = false;\r\n            self.textsTwo.active = false;\r\n            self.btnTwo.getComponent(cc.Sprite).spriteFrame = self.textures[0];\r\n            self.btn.getComponent(cc.Sprite).spriteFrame = self.textures[0];\r\n            self.unschedule(self.mainTime);\r\n            return;\r\n        }\r\n       \r\n        \r\n    },\r\n    start () {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}