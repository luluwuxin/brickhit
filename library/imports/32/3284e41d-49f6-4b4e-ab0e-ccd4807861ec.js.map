{"version":3,"sources":["../../../../../../assets/script/wx/consume/assets/script/wx/consume/consume.js"],"names":["urls","require","config","util","consume","cc","Class","statics","instance","getInstance","ctor","_gold","sys","localStorage","getItem","gold","setItem","parseInt","getGold","addGold","num","subGold","callBack","flag"],"mappings":";;;;;;AAAA,IAAIA,OAAOC,QAAQ,QAAR,EAAkBD,IAA7B;AACA,IAAIE,SAASD,QAAQ,QAAR,CAAb;AACA,IAAIE,OAAOF,QAAQ,eAAR,CAAX;;AAEA,IAAIG,UAAUC,GAAGC,KAAH,CAAS;AACrBC,WAAS;AACLC,cAAU,IADL;AAELC,iBAAa,uBAAY;AACrB,UAAIL,QAAQI,QAAR,IAAoB,IAAxB,EAA8B;AAC5BJ,gBAAQI,QAAR,GAAmB,IAAIJ,OAAJ,EAAnB;AACD;AACD,aAAOA,QAAQI,QAAf;AACH;AAPI,GADY;;AAWrBE,QAAM,gBAAY;AAChB,SAAKC,KAAL,GAAaN,GAAGO,GAAH,CAAOC,YAAP,CAAoBC,OAApB,CAA4B,MAA5B,CAAb;AACA,QAAG,CAAC,CAAC,CAAC,KAAKH,KAAX,EAAiB;AACd,UAAIA,QAAQT,OAAOa,IAAnB;AACAV,SAAGO,GAAH,CAAOC,YAAP,CAAoBG,OAApB,CAA4B,MAA5B,EAAmCL,KAAnC;AACA,WAAKA,KAAL,GAAaA,KAAb;AACF,KAJD,MAIK;AACH,WAAKA,KAAL,GAAaM,SAAS,KAAKN,KAAd,CAAb;AACD;AACD;AACD,GArBoB;AAsBrBO,SAtBqB,qBAsBZ;AACP,WAAO,KAAKP,KAAZ;AACD,GAxBoB;AAyBrBQ,SAzBqB,mBAyBbC,GAzBa,EAyBT;AACR,QAAG,OAAOA,GAAP,IAAc,QAAjB,EAA0B;AACxB;AACD;AACD,SAAKT,KAAL,IAAcS,GAAd;AACA;AACAf,OAAGO,GAAH,CAAOC,YAAP,CAAoBG,OAApB,CAA4B,MAA5B,EAAmC,KAAKL,KAAxC;AACH,GAhCoB;AAiCrBU,SAjCqB,mBAiCbD,GAjCa,EAiCTE,QAjCS,EAiCA;AACnB;AACA,QAAIC,OAAO,KAAX;AACA,QAAG,CAAC,CAAC,CAACH,GAAH,IAAUA,MAAM,KAAKT,KAAxB,EAA8B;AAC5B,UAAGW,YAAY,OAAOA,QAAP,IAAmB,UAAlC,EAA6C;AAC3CA,iBAASC,IAAT;AACD;AACD;AACD;AACDA,WAAO,IAAP;AACA,SAAKZ,KAAL,IAAcS,GAAd;AACA,QAAG,KAAKT,KAAL,GAAa,CAAhB,EAAkB;AAChB,WAAKA,KAAL,GAAa,CAAb;AACD;AACDN,OAAGO,GAAH,CAAOC,YAAP,CAAoBG,OAApB,CAA4B,MAA5B,EAAmC,KAAKL,KAAxC;AACA,QAAGW,YAAY,OAAOA,QAAP,IAAmB,UAAlC,EAA6C;AAC1C;AACAA,eAASC,IAAT;AACF;AACF;AApDoB,CAAT,CAAd;AAuDA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"consume.js","sourceRoot":"../../../../../../assets/script/wx/consume","sourcesContent":["var urls = require('config').urls\r\nvar config = require('config')\r\nvar util = require('../utils/util');\r\n\r\nvar consume = cc.Class({\r\n  statics: {\r\n      instance: null,\r\n      getInstance: function () {\r\n          if (consume.instance == null) {\r\n            consume.instance = new consume();\r\n          }\r\n          return consume.instance;\r\n      }\r\n  },\r\n\r\n  ctor: function () {\r\n    this._gold = cc.sys.localStorage.getItem('Gold');\r\n    if(!!!this._gold){\r\n       let _gold = config.gold;\r\n       cc.sys.localStorage.setItem('Gold',_gold);\r\n       this._gold = _gold;\r\n    }else{\r\n      this._gold = parseInt(this._gold);\r\n    }\r\n    //console.log(\"consume ctor\",this._gold);\r\n  },\r\n  getGold(){\r\n    return this._gold;\r\n  },\r\n  addGold(num){\r\n      if(typeof num != 'number'){\r\n        return;\r\n      }\r\n      this._gold += num;\r\n      //console.log(\"addGold\",this._gold);\r\n      cc.sys.localStorage.setItem('Gold',this._gold);\r\n  },\r\n  subGold(num,callBack){\r\n    //console.log(num,callBack,this._gold)\r\n    let flag = false;\r\n    if(!!!num || num > this._gold){\r\n      if(callBack && typeof callBack == \"function\"){\r\n        callBack(flag)\r\n      }\r\n      return;\r\n    }\r\n    flag = true;\r\n    this._gold -= num;\r\n    if(this._gold < 0){\r\n      this._gold = 0;\r\n    }\r\n    cc.sys.localStorage.setItem('Gold',this._gold);\r\n    if(callBack && typeof callBack == \"function\"){\r\n       //console.log(flag)\r\n       callBack(flag)\r\n    }\r\n  }\r\n\r\n})\r\n// //// 类版本 全局函数太多可以使用类版本\r\n// export default class consume {\r\n//     // 类似构成函数\r\n//     constructor(){\r\n  \r\n//     }; \r\n//     //  loadHongbaoWidget = function(target){\r\n//     //     cc.loader.loadRes(\"wx/hongbao/hongbaoWidget\",cc.Prefab,function(err,prefab){\r\n//     //                 console.log(prefab)\r\n//     //                 var hongbaoWidget = cc.instantiate(prefab);\r\n//     //                 target.node.addChild(hongbaoWidget);\r\n//     //                 hongbaoWidget.active = false;\r\n//     //                 target.hongbaoWidget = hongbaoWidget;\r\n//     //             })\r\n//     //   };\r\n    \r\n//       getGold = function(callBack){\r\n//         var url = urls.user +\"/get_gold\";\r\n//         var param = {\r\n//           };\r\n//         util.request({\r\n//             url: url,\r\n//             data: param,\r\n//             method: 'get',\r\n//             success:res=>{\r\n//                 console.log(\"getGold Success\")\r\n                \r\n//                 console.log(res.data);\r\n//                 if (callBack && typeof callBack == 'function') callBack(res.data.data)\r\n//             },\r\n//             fail: function (er) {\r\n//                 console.error(er);\r\n//               }\r\n//         })    \r\n//       };\r\n//       addGold = function(callBack,_num){\r\n//         var url = urls.user +\"/add_gold\";\r\n//         var param = {\r\n//             num:_num,\r\n//           };\r\n//         util.request({\r\n//             url: url,\r\n//             data: param,\r\n//             header: { 'content-type': 'application/x-www-form-urlencoded' },\r\n//             method: 'POST',\r\n//             success:res=>{\r\n//                 console.log(\"addGold Success\")\r\n//                 console.log(res.data);\r\n//                 if (callBack && typeof callBack == 'function') callBack(res.data.data)\r\n//             },\r\n//             fail: function (er) {\r\n//                 console.error(er);\r\n//               }\r\n//         })\r\n//       };\r\n//       subGold = function(callBack,_num){\r\n//         var url = urls.user +\"/sub_gold\";\r\n//         var param = {\r\n//             num:_num,\r\n//           };\r\n//         util.request({\r\n//             url: url,\r\n//             data: param,\r\n//             header: { 'content-type': 'application/x-www-form-urlencoded' },\r\n//             method: 'POST',\r\n//             success:res=>{\r\n//                 console.log(\"getGold Success\")\r\n\r\n//                 console.log(res.data);\r\n//                 if (callBack && typeof callBack == 'function') callBack(res.data.data)\r\n//             },\r\n//             fail: function (er) {\r\n//                 console.error(er);\r\n//               }\r\n//         })    \r\n//       };\r\n// }\r\n\r\n"]}