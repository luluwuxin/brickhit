{"version":3,"sources":["../../../../../assets/scripts/adb/assets/scripts/adb/BannerBlock.js"],"names":["bannerWidth","bannerTop","bannerId","adTime","wxBversionLess","vs","cc","sys","platform","WECHAT_GAME","bVersion","wx","getSystemInfoSync","SDKVersion","vs2vn","parseInt","split","join","slice","Class","extends","Component","properties","onLoad","replace","old","_bannerAd","_prevAd","create","refresh","hide","destroy","myWidth","myHeight","adHeight","res","screenWidth","screenHeight","console","log","dh","dw","bannerAd","createBannerAd","adUnitId","style","left","top","width","show","_showBannerAd","startLoop","schedule","stopLoop","unschedule","destroyIt","onDestroy","unscheduleAllCallbacks","start"],"mappings":";;;;;;AAAA,IAAMA,cAAc,GAApB;AACA,IAAMC,YAAY,GAAlB;AACA,IAAMC,WAAW,yBAAjB,EAA2C;AAC3C,IAAMC,SAAS,GAAf,EAAwB;;AAExB,IAAIC,iBAAgB,SAAhBA,cAAgB,CAACC,EAAD,EAAQ;AACxB,QAAIC,GAAGC,GAAH,CAAOC,QAAP,IAAmBF,GAAGC,GAAH,CAAOE,WAA9B,EAA2C;AACvC,YAAIC,WAAWC,GAAGC,iBAAH,GAAuBC,UAAtC;AACA,YAAIC,QAAQ,SAARA,KAAQ,CAACT,EAAD,EAAQ;AAChB,mBAAOU,SAASV,GAAGW,KAAH,CAAS,GAAT,EAAcC,IAAd,CAAmB,EAAnB,EAAuBC,KAAvB,CAA6B,CAA7B,EAAgC,CAAhC,CAAT,CAAP;AACH,SAFD;AAGA,eAAOJ,MAAMJ,QAAN,IAAkBI,MAAMT,EAAN,CAAzB;AACH;AACD,WAAO,IAAP;AACH,CATD;AAUAC,GAAGa,KAAH,CAAS;AACLC,aAASd,GAAGe,SADP;;AAGLC,gBAAY;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfQ,KAHP;;AAqBL;;AAECC,UAvBI,oBAuBM,CAET,CAzBG;;;AA2BLC,aAAS,mBAAU;AACf,YAAIC,MAAM,KAAKC,SAAf;AACA,aAAKA,SAAL,GAAiB,KAAKC,OAAtB;AACA,aAAKA,OAAL,GAAe,KAAKC,MAAL,EAAf;AACA,aAAKC,OAAL;AACA,YAAGJ,GAAH,EAAO;AACHA,gBAAIK,IAAJ;AACAL,gBAAIM,OAAJ;AACH;AACJ,KApCI;AAqCL;AACAH,YAAQ,kBAAU;AACd;AACA,YAAG,CAACxB,eAAe,OAAf,CAAJ,EAA4B;AACxB,gBAAI4B,UAAU,CAAd,CADwB,CACP;AACjB,gBAAIC,WAAW,CAAf,CAFwB,CAEP;AACjB,gBAAIC,WAAW,CAAf,CAHwB,CAGN;;AAElB;;AAEA,gBAAIC,MAAMxB,GAAGC,iBAAH,EAAV;AACAoB,sBAAUG,IAAIC,WAAd;AACAH,uBAAWE,IAAIE,YAAf;AACAC,oBAAQC,GAAR,CAAYJ,GAAZ;;AAEA,gBAAIK,KAAKP,WAAWhC,SAApB;AACA,gBAAIwC,KAAK,CAACT,UAAUhC,WAAX,IAA0B,CAAnC;AACA,gBAAI0C,WAAW/B,GAAGgC,cAAH,CAAkB;AAC7BC,0BAAU1C,QADmB;AAE7B2C,uBAAO;AACHC,0BAAML,EADH;AAEHM,yBAAKP,EAFF;AAGHQ,2BAAOhD;AACP;AAJG;AAFsB,aAAlB,CAAf;;AAUA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAO0C,QAAP;AACH;AACJ,KA3EI;;AA6EL;AACAO,UAAM,gBAAY;AACd;AACA,aAAKC,aAAL,GAAqB,IAArB;AACA,aAAKrB,OAAL;AACH,KAlFI;AAmFLC,UAAM,gBAAY;AACd;AACA,aAAKoB,aAAL,GAAqB,KAArB;AACA,aAAKrB,OAAL;AACH,KAvFI;AAwFL;AACAsB,eAAU,qBAAU;AAChB,aAAK3B,OAAL;AACA,aAAKA,OAAL;AACA,aAAKyB,IAAL;AACA,aAAKG,QAAL,CAAc,KAAK5B,OAAnB,EAA4BrB,MAA5B;AACH,KA9FI;AA+FLkD,YA/FK,sBA+FK;AACN,aAAKC,UAAL,CAAgB,KAAK9B,OAArB,EAA8B,IAA9B;AACA;AACH,KAlGI;;;AAoGLK,aAAQ,mBAAU;AACd,YAAG,KAAKH,SAAR,EAAmB,KAAKwB,aAAL,GAAqB,KAAKxB,SAAL,CAAeuB,IAAf,EAArB,GAA6C,KAAKvB,SAAL,CAAeI,IAAf,EAA7C;AACtB,KAtGI;AAuGLyB,eAAW,qBAAU;AACjB,YAAG,KAAK7B,SAAR,EAAmB;AACf,gBAAID,MAAM,KAAKC,SAAf;AACA,iBAAKA,SAAL,GAAiB,IAAjB;AACAD,gBAAIK,IAAJ;AACAL,gBAAIM,OAAJ;AACH;AACD,YAAG,KAAKJ,OAAR,EAAiB;AACb,gBAAIF,OAAM,KAAKE,OAAf;AACA,iBAAKD,SAAL,GAAiB,IAAjB;AACAD,iBAAIK,IAAJ;AACAL,iBAAIM,OAAJ;AACH;AACJ,KApHI;AAqHLyB,eAAW,qBAAY;AACnB,aAAKC,sBAAL;AACA,aAAKF,SAAL;AACH,KAxHI;AAyHLG,SAzHK,mBAyHI,CAER;AA3HI;;AA6HL;AA7HJ","file":"BannerBlock.js","sourceRoot":"../../../../../assets/scripts/adb","sourcesContent":["const bannerWidth = 300;\r\nconst bannerTop = 100;\r\nconst bannerId = \"adunit-98121687e3c35615\";//广告id，自定义\r\nconst adTime = 180;     //loop 周期\r\n\r\nvar wxBversionLess= (vs) => {\r\n    if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n        let bVersion = wx.getSystemInfoSync().SDKVersion;\r\n        var vs2vn = (vs) => {\r\n            return parseInt(vs.split(\".\").join(\"\").slice(0, 3));\r\n        }\r\n        return vs2vn(bVersion) < vs2vn(vs);\r\n    }\r\n    return true;\r\n};\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n     onLoad () {\r\n        \r\n     },\r\n     \r\n    replace: function(){\r\n        let old = this._bannerAd;\r\n        this._bannerAd = this._prevAd;\r\n        this._prevAd = this.create();\r\n        this.refresh();\r\n        if(old){\r\n            old.hide();\r\n            old.destroy();\r\n        }\r\n    },\r\n    //创建广告\r\n    create: function(){\r\n        //if (cc.sys.platform == cc.sys.WECHAT_GAME ) {\r\n        if(!wxBversionLess(\"2.0.4\")){\r\n            let myWidth = 0; //屏幕宽度\r\n            let myHeight = 0;//屏幕高度\r\n            let adHeight = 0; //广告高度\r\n\r\n            //得到屏幕尺\r\n\r\n            let res = wx.getSystemInfoSync()\r\n            myWidth = res.screenWidth;\r\n            myHeight = res.screenHeight;\r\n            console.log(res)\r\n\r\n            let dh = myHeight - bannerTop;\r\n            let dw = (myWidth - bannerWidth) / 2;\r\n            let bannerAd = wx.createBannerAd({\r\n                adUnitId: bannerId,\r\n                style: {\r\n                    left: dw,\r\n                    top: dh,\r\n                    width: bannerWidth,\r\n                    //height: 50,\r\n                }\r\n            })\r\n\r\n            //监听隐藏广告，得到真实的广告高度\r\n            //bannerAd.onResize(function (res) {\r\n            //    adHeight = res.height;  //125\r\n            //    dh = myHeight - adHeight;\r\n            //    console.log(\"#############\", adHeight);\r\n            //})\r\n\r\n            //显示广告\r\n            //this._bannerAd = bannerAd;\r\n            return bannerAd;\r\n        }\r\n    },\r\n\r\n    //显示开关\r\n    show: function () {\r\n        //if (this._bannerAd) this._bannerAd.show();\r\n        this._showBannerAd = true;\r\n        this.refresh();\r\n    },\r\n    hide: function () {\r\n        //if (this._bannerAd) this._bannerAd.hide();\r\n        this._showBannerAd = false;\r\n        this.refresh();\r\n    },\r\n    //轮询开关\r\n    startLoop:function(){\r\n        this.replace();\r\n        this.replace();\r\n        this.show();\r\n        this.schedule(this.replace, adTime);\r\n    },\r\n    stopLoop(){\r\n        this.unschedule(this.replace, this);\r\n        //this.hide();\r\n    },\r\n    \r\n    refresh:function(){\r\n        if(this._bannerAd) this._showBannerAd ? this._bannerAd.show() : this._bannerAd.hide();\r\n    },\r\n    destroyIt: function(){\r\n        if(this._bannerAd) {\r\n            let old = this._bannerAd;\r\n            this._bannerAd = null;\r\n            old.hide();\r\n            old.destroy();\r\n        }\r\n        if(this._prevAd) {\r\n            let old = this._prevAd;\r\n            this._bannerAd = null;\r\n            old.hide();\r\n            old.destroy();\r\n        }\r\n    },\r\n    onDestroy: function () {\r\n        this.unscheduleAllCallbacks();\r\n        this.destroyIt();\r\n    },\r\n    start () {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});"]}