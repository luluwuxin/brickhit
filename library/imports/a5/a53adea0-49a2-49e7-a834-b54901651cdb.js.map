{"version":3,"sources":["../../../../../assets/scripts/common/assets/scripts/common/UsrData.js"],"names":["common","require","Const","getUsrData","getStorageSync","usrData","setUsrData","val","setStorageSync","defaultData","sound","UsrData","cc","Class","properties","get","_data","set","gameStartSeconds","Date","parse","timestamp","instance","data","self","window","undefined"],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAIA,SAASC,QAAQ,QAAR,CAAb;AACA,IAAIC,QAAQD,QAAQ,OAAR,CAAZ;AACA,IAAIE,aAAa,SAAbA,UAAa;AAAA,WAASH,OAAOI,cAAP,CAAsBF,MAAMG,OAA5B,CAAT;AAAA,CAAjB;AACA,IAAIC,aAAa,SAAbA,UAAa,CAACC,GAAD;AAAA,WAASP,OAAOQ,cAAP,CAAsBN,MAAMG,OAA5B,EAAqCE,GAArC,CAAT;AAAA,CAAjB;AACA,IAAIE,cAAc,EAACC,OAAO,IAAR,EAAlB;AACA,IAAIC,UAAUC,GAAGC,KAAH,CAAS;AACnBC,gBAAW;AACP;AACAJ,eAAO;AACHK,eADG,iBACE;AACD;AACA,uBAAO,QAAO,KAAKC,KAAL,CAAWN,KAAlB,aAAkCD,YAAYC,KAA9C,IAAuDD,YAAYC,KAAnE,GAA2E,KAAKM,KAAL,CAAWN,KAA7F;AACH,aAJE;AAKHO,eALG,eAKCV,GALD,EAKK;AACJ,qBAAKS,KAAL,CAAWN,KAAX,GAAmBH,GAAnB;AACAD,2BAAW,KAAKU,KAAhB;AACH;AARE,SAFA;;AAaP;;AAEAE,0BAAiB;AACbH,eADa,iBACR;AACD,uBAAO,CAACI,KAAKC,KAAL,CAAW,IAAID,IAAJ,EAAX,IAAyB,KAAKH,KAAL,CAAWK,SAArC,IAAkD,IAAzD;AACH;AAHY;AAfV,KADQ;AAsBnBC,cAAU,oBAAU;AAChB,YAAIC,OAAOpB,YAAX;AACA,YAAG,CAACoB,IAAJ,EAAS;AACL,iBAAKP,KAAL,GAAaP,WAAb;AACA,iBAAKO,KAAL,CAAWK,SAAX,GAAuBF,KAAKC,KAAL,CAAW,IAAID,IAAJ,EAAX,CAAvB;AACAb,uBAAW,KAAKU,KAAhB;AACH,SAJD,MAKK,KAAKA,KAAL,GAAaO,IAAb;AACL;AACA,eAAO,IAAP;AACH;AAhCkB,CAAT,CAAd;AAkCA,IAAIC,IAAJ;;AAEA;AACAC,OAAOtB,UAAP,GAAoB,YAAM;AACtB,QAAGqB,QAAQE,SAAX,EAAsB,OAAOF,IAAP;AACtBA,WAAO,IAAIb,OAAJ,EAAP;AACA,WAAOa,KAAKF,QAAL,EAAP;AACH,CAJD","file":"UsrData.js","sourceRoot":"../../../../../assets/scripts/common","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\r\nvar common = require(\"Common\");\r\nvar Const = require(\"Const\");\r\nvar getUsrData = ()     =>common.getStorageSync(Const.usrData);\r\nvar setUsrData = (val)  =>common.setStorageSync(Const.usrData, val);\r\nlet defaultData = {sound: true};\r\nvar UsrData = cc.Class({\r\n    properties:{\r\n        //本地存储\r\n        sound: {\r\n            get(){\r\n                //向前兼容\r\n                return typeof this._data.sound != typeof defaultData.sound  ? defaultData.sound : this._data.sound;\r\n            },\r\n            set(val){\r\n                this._data.sound = val;\r\n                setUsrData(this._data);\r\n            },\r\n        },\r\n        \r\n        //---------------------------------------------------------------华丽的分割线-----------------------------------------------\r\n\r\n        gameStartSeconds:{\r\n            get(){\r\n                return (Date.parse(new Date()) - this._data.timestamp) / 1000;\r\n            },\r\n        },\r\n    },\r\n    instance: function(){\r\n        let data = getUsrData();\r\n        if(!data){\r\n            this._data = defaultData;\r\n            this._data.timestamp = Date.parse(new Date());\r\n            setUsrData(this._data);\r\n        }\r\n        else this._data = data;\r\n        //this._data = data ? data : defaultData;\r\n        return this;\r\n    },\r\n});\r\nvar self;\r\n\r\n//单例\r\nwindow.getUsrData = () => {\r\n    if(self != undefined) return self;\r\n    self = new UsrData();\r\n    return self.instance();\r\n};"]}