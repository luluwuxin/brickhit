{"version":3,"sources":["Rabbit.js"],"names":["C","window","require","Crypto","util","charenc","UTF8","Binary","x","c","b","Rabbit","encrypt","message","password","m","stringToBytes","iv","randomBytes","k","constructor","String","PBKDF2","asBytes","_rabbit","bytesToWords","bytesToBase64","concat","decrypt","ciphertext","base64ToBytes","splice","bytesToString","_keysetup","_ivsetup","s","i","length","_nextstate","j","rotl","i0","endian","i2","i1","i3","c_old","g","gx","ga","gb","gh","gl"],"mappings":"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","file":"Rabbit.js","sourceRoot":"../../../../../../../../assets/script/wx/utils/cryptojs/lib","sourcesContent":["(function(){\r\n\r\nvar C = (typeof window === 'undefined') ? require('./Crypto').Crypto : window.Crypto;\r\n\r\n// Shortcuts\r\nvar util = C.util,\r\n    charenc = C.charenc,\r\n    UTF8 = charenc.UTF8,\r\n    Binary = charenc.Binary;\r\n\r\n// Inner state\r\nvar x = [],\r\n    c = [],\r\n    b;\r\n\r\nvar Rabbit = C.Rabbit = {\r\n\r\n\t/**\r\n\t * Public API\r\n\t */\r\n\r\n\tencrypt: function (message, password) {\r\n\r\n\t\tvar\r\n\r\n\t\t    // Convert to bytes\r\n\t\t    m = UTF8.stringToBytes(message),\r\n\r\n\t\t    // Generate random IV\r\n\t\t    iv = util.randomBytes(8),\r\n\r\n\t\t    // Generate key\r\n\t\t    k = password.constructor == String ?\r\n\t\t        // Derive key from passphrase\r\n\t\t        C.PBKDF2(password, iv, 32, { asBytes: true }) :\r\n\t\t        // else, assume byte array representing cryptographic key\r\n\t\t        password;\r\n\r\n\t\t// Encrypt\r\n\t\tRabbit._rabbit(m, k, util.bytesToWords(iv));\r\n\r\n\t\t// Return ciphertext\r\n\t\treturn util.bytesToBase64(iv.concat(m));\r\n\r\n\t},\r\n\r\n\tdecrypt: function (ciphertext, password) {\r\n\r\n\t\tvar\r\n\r\n\t\t    // Convert to bytes\r\n\t\t    c = util.base64ToBytes(ciphertext),\r\n\r\n\t\t    // Separate IV and message\r\n\t\t    iv = c.splice(0, 8),\r\n\r\n\t\t    // Generate key\r\n\t\t    k = password.constructor == String ?\r\n\t\t        // Derive key from passphrase\r\n\t\t        C.PBKDF2(password, iv, 32, { asBytes: true }) :\r\n\t\t        // else, assume byte array representing cryptographic key\r\n\t\t        password;\r\n\r\n\t\t// Decrypt\r\n\t\tRabbit._rabbit(c, k, util.bytesToWords(iv));\r\n\r\n\t\t// Return plaintext\r\n\t\treturn UTF8.bytesToString(c);\r\n\r\n\t},\r\n\r\n\r\n\t/**\r\n\t * Internal methods\r\n\t */\r\n\r\n\t// Encryption/decryption scheme\r\n\t_rabbit: function (m, k, iv) {\r\n\r\n\t\tRabbit._keysetup(k);\r\n\t\tif (iv) Rabbit._ivsetup(iv);\r\n\r\n\t\tfor (var s = [], i = 0; i < m.length; i++) {\r\n\r\n\t\t\tif (i % 16 == 0) {\r\n\r\n\t\t\t\t// Iterate the system\r\n\t\t\t\tRabbit._nextstate();\r\n\r\n\t\t\t\t// Generate 16 bytes of pseudo-random data\r\n\t\t\t\ts[0] = x[0] ^ (x[5] >>> 16) ^ (x[3] << 16);\r\n\t\t\t\ts[1] = x[2] ^ (x[7] >>> 16) ^ (x[5] << 16);\r\n\t\t\t\ts[2] = x[4] ^ (x[1] >>> 16) ^ (x[7] << 16);\r\n\t\t\t\ts[3] = x[6] ^ (x[3] >>> 16) ^ (x[1] << 16);\r\n\r\n\t\t\t\t// Swap endian\r\n\t\t\t\tfor (var j = 0; j < 4; j++) {\r\n\t\t\t\t\ts[j] = ((s[j] <<  8) | (s[j] >>> 24)) & 0x00FF00FF |\r\n\t\t\t\t\t       ((s[j] << 24) | (s[j] >>>  8)) & 0xFF00FF00;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Convert words to bytes\r\n\t\t\t\tfor (var b = 120; b >= 0; b -= 8)\r\n\t\t\t\t\ts[b / 8] = (s[b >>> 5] >>> (24 - b % 32)) & 0xFF;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tm[i] ^= s[i % 16];\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t// Key setup scheme\r\n\t_keysetup: function (k) {\r\n\r\n\t\t// Generate initial state values\r\n\t\tx[0] = k[0];\r\n\t\tx[2] = k[1];\r\n\t\tx[4] = k[2];\r\n\t\tx[6] = k[3];\r\n\t\tx[1] = (k[3] << 16) | (k[2] >>> 16);\r\n\t\tx[3] = (k[0] << 16) | (k[3] >>> 16);\r\n\t\tx[5] = (k[1] << 16) | (k[0] >>> 16);\r\n\t\tx[7] = (k[2] << 16) | (k[1] >>> 16);\r\n\r\n\t\t// Generate initial counter values\r\n\t\tc[0] = util.rotl(k[2], 16);\r\n\t\tc[2] = util.rotl(k[3], 16);\r\n\t\tc[4] = util.rotl(k[0], 16);\r\n\t\tc[6] = util.rotl(k[1], 16);\r\n\t\tc[1] = (k[0] & 0xFFFF0000) | (k[1] & 0xFFFF);\r\n\t\tc[3] = (k[1] & 0xFFFF0000) | (k[2] & 0xFFFF);\r\n\t\tc[5] = (k[2] & 0xFFFF0000) | (k[3] & 0xFFFF);\r\n\t\tc[7] = (k[3] & 0xFFFF0000) | (k[0] & 0xFFFF);\r\n\r\n\t\t// Clear carry bit\r\n\t\tb = 0;\r\n\r\n\t\t// Iterate the system four times\r\n\t\tfor (var i = 0; i < 4; i++) Rabbit._nextstate();\r\n\r\n\t\t// Modify the counters\r\n\t\tfor (var i = 0; i < 8; i++) c[i] ^= x[(i + 4) & 7];\r\n\r\n\t},\r\n\r\n\t// IV setup scheme\r\n\t_ivsetup: function (iv) {\r\n\r\n\t\t// Generate four subvectors\r\n\t\tvar i0 = util.endian(iv[0]),\r\n\t\t    i2 = util.endian(iv[1]),\r\n\t\t    i1 = (i0 >>> 16) | (i2 & 0xFFFF0000),\r\n\t\t    i3 = (i2 <<  16) | (i0 & 0x0000FFFF);\r\n\r\n\t\t// Modify counter values\r\n\t\tc[0] ^= i0;\r\n\t\tc[1] ^= i1;\r\n\t\tc[2] ^= i2;\r\n\t\tc[3] ^= i3;\r\n\t\tc[4] ^= i0;\r\n\t\tc[5] ^= i1;\r\n\t\tc[6] ^= i2;\r\n\t\tc[7] ^= i3;\r\n\r\n\t\t// Iterate the system four times\r\n\t\tfor (var i = 0; i < 4; i++) Rabbit._nextstate();\r\n\r\n\t},\r\n\r\n\t// Next-state function\r\n\t_nextstate: function () {\r\n\r\n\t\t// Save old counter values\r\n\t\tfor (var c_old = [], i = 0; i < 8; i++) c_old[i] = c[i];\r\n\r\n\t\t// Calculate new counter values\r\n\t\tc[0] = (c[0] + 0x4D34D34D + b) >>> 0;\r\n\t\tc[1] = (c[1] + 0xD34D34D3 + ((c[0] >>> 0) < (c_old[0] >>> 0) ? 1 : 0)) >>> 0;\r\n\t\tc[2] = (c[2] + 0x34D34D34 + ((c[1] >>> 0) < (c_old[1] >>> 0) ? 1 : 0)) >>> 0;\r\n\t\tc[3] = (c[3] + 0x4D34D34D + ((c[2] >>> 0) < (c_old[2] >>> 0) ? 1 : 0)) >>> 0;\r\n\t\tc[4] = (c[4] + 0xD34D34D3 + ((c[3] >>> 0) < (c_old[3] >>> 0) ? 1 : 0)) >>> 0;\r\n\t\tc[5] = (c[5] + 0x34D34D34 + ((c[4] >>> 0) < (c_old[4] >>> 0) ? 1 : 0)) >>> 0;\r\n\t\tc[6] = (c[6] + 0x4D34D34D + ((c[5] >>> 0) < (c_old[5] >>> 0) ? 1 : 0)) >>> 0;\r\n\t\tc[7] = (c[7] + 0xD34D34D3 + ((c[6] >>> 0) < (c_old[6] >>> 0) ? 1 : 0)) >>> 0;\r\n\t\tb = (c[7] >>> 0) < (c_old[7] >>> 0) ? 1 : 0;\r\n\r\n\t\t// Calculate the g-values\r\n\t\tfor (var g = [], i = 0; i < 8; i++) {\r\n\r\n\t\t\tvar gx = (x[i] + c[i]) >>> 0;\r\n\r\n\t\t\t// Construct high and low argument for squaring\r\n\t\t\tvar ga = gx & 0xFFFF,\r\n\t\t\t    gb = gx >>> 16;\r\n\r\n\t\t\t// Calculate high and low result of squaring\r\n\t\t\tvar gh = ((((ga * ga) >>> 17) + ga * gb) >>> 15) + gb * gb,\r\n\t\t\t    gl = (((gx & 0xFFFF0000) * gx) >>> 0) + (((gx & 0x0000FFFF) * gx) >>> 0) >>> 0;\r\n\r\n\t\t\t// High XOR low\r\n\t\t\tg[i] = gh ^ gl;\r\n\r\n\t\t}\r\n\r\n\t\t// Calculate new state values\r\n\t\tx[0] = g[0] + ((g[7] << 16) | (g[7] >>> 16)) + ((g[6] << 16) | (g[6] >>> 16));\r\n\t\tx[1] = g[1] + ((g[0] <<  8) | (g[0] >>> 24)) + g[7];\r\n\t\tx[2] = g[2] + ((g[1] << 16) | (g[1] >>> 16)) + ((g[0] << 16) | (g[0] >>> 16));\r\n\t\tx[3] = g[3] + ((g[2] <<  8) | (g[2] >>> 24)) + g[1];\r\n\t\tx[4] = g[4] + ((g[3] << 16) | (g[3] >>> 16)) + ((g[2] << 16) | (g[2] >>> 16));\r\n\t\tx[5] = g[5] + ((g[4] <<  8) | (g[4] >>> 24)) + g[3];\r\n\t\tx[6] = g[6] + ((g[5] << 16) | (g[5] >>> 16)) + ((g[4] << 16) | (g[4] >>> 16));\r\n\t\tx[7] = g[7] + ((g[6] <<  8) | (g[6] >>> 24)) + g[5];\r\n\r\n\t}\r\n\r\n};\r\n\r\n})();\r\n"]}