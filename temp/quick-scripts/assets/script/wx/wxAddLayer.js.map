{"version":3,"sources":["wxAddLayer.js"],"names":["userOperate","require","config","rank","share","hongbao","match","global","tokenUrl","consume","getInstance","matchManager","lottery","MSG","shareUtil","preview","myAssist","commonNode","self","cc","Class","extends","Component","properties","onLoad","_localScore","_isShareWithGold","initData","loadWidget","loadShareGroupInfo","_userOperate","_rank","_share","loadRankWidget","loadQunRankWidget","loadFriendRankWidget","loadMyAssistWidget","loadAssistLayerTwo","callback","floats","getVit","res","console","log","vit","setUserDataInfoByName","start","getShareAssist","showMeReq","showHelpTips","setShareAssist","_assistCallBack","getEnterGameRandStr","_flyText","color","setEnterGameRandStr","callBack","_asTimes","Math","floor","random","schedule","assistTime","showMeRequst","unschedule","addGold","rankBtn","event","customData","sys","platform","WECHAT_GAME","getRank","rankWidget","active","js","getComponent","init","data","rankQunBtn","groupOpenGID","getQunRank","qunRankWidget","shareBtnWithScore","gold","getLocalScore","shareAppMessageWithGold","shareAppMessage","shareBtnWithRevived","func","assistLayerTwo","shareAppMessageWithRevived","shareBtnWithAssit","shareAppMessageWithAssit","shareBtn","shareBtnWithUrl","shareAppMessageWithImgUrl","shareBtnWithGroup","shareAppMessageForGroup","shareBtnWithSpecial","obj","shareAppMessageWithSpecial","getShareTicketTime","times","shareGroupTime","hongbaoBtn","hasMatch","matchBtn","showMatchRankView","getFriendsRankBtn","wx","getOpenDataContext","openDataContext","postMessage","id","MessageID","ON_MSG_GET_FRIEND_RANK_OPEN","friendRank","initRank","setNextFriendInfoBtn","ON_MSG_GET_NEXT_PEOPLE","openid","UID","getOpenDataQunRankBtn","shareTicket","ON_MSG_GET_GROUP_RANK_OPEN","assistBtn","myAssistWidget","assistTwoBtn","getVitBtn","subVitBtn","parseInt","subVit","num","getUserDataInfoByName","_text","strokeColor","time","textNode","Node","addComponent","Label","LabelOutline","winSize","node","getContentSize","setContentSize","width","text","string","fontSize","lineHeight","overflow","Overflow","RESIZE_HEIGHT","textOutLine","addChild","size","fadeOut","move","moveBy","p","runAction","sequence","delayTime","spawn","callFunc","destroy","getScore","setScore","score","addGameStartTimes","setCurLocalScore","checkScore","getLowScoreTimes","topScore","getHeightScoreTimes","setHeightScoreTimes","setLowScoreTimes","setLocalScore","setCustomData","blob","setBlob","getGold","subGold","_num","openVitTimers","onDestroy","startActivity","runLottery","type","quitActivity","saveOfficalAccount","find","officalAccLoad","moreGame","previewImage","officalAccActive","show","loadRes","addStartGameTimes","getGameStartTimes","getStartGameTimes"],"mappings":"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","file":"wxAddLayer.js","sourceRoot":"../../../../../assets/script/wx","sourcesContent":["\r\n//import userOperate from './userOperate/userOperate';\r\n\r\n// Learn cc.Class:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\r\n\r\n/**\r\n * 提示\r\n * global 保存了从服务器拉下来的用户数据, userOperate.getUserData\r\n * \r\n */\r\nvar userOperate = require('userOperate');\r\nvar config = require('config');\r\nvar rank = require('./rank/rank');\r\nvar share = require('./share/share');\r\nvar hongbao = require('./hongbao/hongbao')\r\nvar match = require('./match/match')\r\nvar global = require('./global/global');\r\nvar tokenUrl = require('./utils/tokenMgr');\r\nvar consume = require('consume').getInstance();\r\nvar matchManager = require('matchManager').getInstance();\r\nvar lottery = require('lottery');\r\nvar MSG = require('./global/messageId');\r\nvar shareUtil = require('shareUtil').getInstance();\r\nvar preview = require('./savePhotos/preview');\r\n// 友助\r\nvar myAssist = require('myAssist').getInstance();\r\nvar commonNode = require('commonNode');\r\nvar self = null;\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n        self = this;\r\n        self._localScore = 0;\r\n        self._isShareWithGold = false;\r\n        self.initData();\r\n        self.loadWidget();\r\n        shareUtil.loadShareGroupInfo();\r\n\r\n        //console.log(\"LLLLLLLLLLLLLLLLLL\",self.node.parent);\r\n\r\n\r\n        //30秒拉取一次比赛活动\r\n        // self.schedule(function() {\r\n        //     console.log(\"get match info...\");\r\n        //     self._match.update(self);\r\n        // }, 30);\r\n        // if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n        //     self.scheduleOnce(function() {\r\n        //         console.log(\"get match info...\");\r\n        //         // self._match.update();\r\n        //         matchManager.update();\r\n        //     }, 3);\r\n        // }\r\n    },\r\n    /**\r\n     * \r\n     * 初始化data\r\n     */\r\n    initData() {\r\n        self._userOperate = new userOperate();\r\n        //self._hongbao = new hongbao();\r\n        self._rank = new rank();\r\n        self._share = new share();\r\n        // self._match = new match();\r\n    },\r\n\r\n    /**\r\n     * 加载  prefab(widget)\r\n     */\r\n    loadWidget() {\r\n        // wx 添加排行榜 rank layer\r\n        self._rank.loadRankWidget(self);\r\n        self._rank.loadQunRankWidget(self);\r\n        self._rank.loadFriendRankWidget(self);\r\n        myAssist.loadMyAssistWidget(self);\r\n        myAssist.loadAssistLayerTwo(self);\r\n        //self._hongbao.loadHongbaoWidget(self);\r\n        // wx 添加match相关widgets\r\n        // matchManager.loadMatchHongbaoIcon(self);\r\n        // matchManager.loadMatchShareWidget(self);\r\n        // matchManager.loadMatchRankWidget(self);\r\n        // matchManager.setTarget(self);\r\n\r\n    },\r\n\r\n    /**\r\n     * 体力定时器\r\n     * @param {*无意义} floats \r\n     */\r\n    callback(floats) {\r\n        self._userOperate.getVit(function (res) {\r\n            console.log(res);\r\n            if (res.vit) {\r\n                global.setUserDataInfoByName('vit', res.vit)\r\n            }\r\n        })\r\n    },\r\n    start() {\r\n\r\n        //   self.setFriendsRankScore(20);  \r\n        //   self.node.runAction(cc.sequence(cc.delayTime(0.5),cc.callFunc(function(){\r\n        //     self.getFriendsRankBtn();\r\n        //   })))\r\n        //////////////////////////////////////////\r\n        if(global.getShareAssist()){\r\n            self.showMeReq(); \r\n        }\r\n        self.showHelpTips();\r\n\r\n        commonNode.getInstance();\r\n    },\r\n\r\n    /**\r\n     * 进入其他界面，重新更新 金币\r\n     */\r\n    setShareAssist(callback){\r\n        self._assistCallBack = callback;\r\n    },\r\n    /**\r\n     * callback 为更新分数接口\r\n     * @param {*} callback \r\n     */\r\n    showHelpTips(callback){\r\n        if(global.getEnterGameRandStr()){\r\n            self._flyText(\"已经助力伙伴,获取灵气，共同获得\"+config.myAssist+\"金币！\",cc.color(255,255,255),cc.color(0,0,0),3);\r\n            global.setEnterGameRandStr(false);\r\n            if(callback){\r\n                callback();\r\n                //self._assistCallBack = callback;\r\n            }\r\n        }\r\n\r\n    },\r\n    showMeReq(callBack){\r\n        if(callBack && typeof callBack === 'function'){\r\n            self._assistCallBack = callBack; \r\n        }\r\n        global.setShareAssist(true);\r\n        self._asTimes =  Math.floor(Math.random()*10) % 10 + 10;\r\n        self.schedule(self.assistTime,1);\r\n    },\r\n    assistTime(){\r\n        if(self._asTimes <= 0){\r\n            self.showMeRequst();\r\n            global.setShareAssist(false);\r\n            self.unschedule(self.assistTime);\r\n            return;\r\n        }\r\n        self._asTimes--;\r\n    },\r\n    showMeRequst(){\r\n        self._flyText(\"收集满小伙们提供的助力灵气，获得\"+config.myAssist+\"金币！\",cc.color(255,255,255),cc.color(0,0,0),3);\r\n        self.addGold(config.myAssist);\r\n        if(self._assistCallBack ){\r\n            self._assistCallBack ();\r\n        }\r\n    },\r\n\r\n    // update() {\r\n\r\n    // },\r\n    /** \r\n     * 排行榜 customData = true ，表示拉取周排行 无 则表示总排行\r\n     * \r\n     */\r\n    rankBtn(event, customData) {\r\n        console.log(event, customData)\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            self._rank.getRank(function (res) {\r\n                //console.log(res)\r\n                if (res && res[\"data\"]) {\r\n                    self.rankWidget.active = true\r\n                    var js = self.rankWidget.getComponent('rankLayer');\r\n                    js.init(res.data, function () {\r\n                    })\r\n                }\r\n            }, customData);\r\n        }\r\n    },\r\n    rankQunBtn(event, customData) {\r\n        customData = customData || \"true\";\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            if (config.groupOpenGID) {\r\n                self._rank.getQunRank(config.groupOpenGID, function (res) {\r\n                    //console.log(res)\r\n                    if (res && res[\"data\"]) {\r\n                        self.qunRankWidget.active = true\r\n                        var js = self.qunRankWidget.getComponent('rankQunLayer');\r\n                        js.init(res.data, function () {\r\n                        })\r\n                    }\r\n                }, customData);\r\n            }\r\n        }\r\n    },\r\n\r\n    /** \r\n     * 分享\r\n     * 炫耀成绩\r\n     * \r\n     * gold 分享获得金币 数量，\r\n     */\r\n    shareBtnWithScore(event,callBack, gold){\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            self._localScore = self._userOperate.getLocalScore();\r\n            //console.log(\"localScore\",self._localScore,self._isShareWithGold)\r\n            if (typeof self._localScore == 'number') {\r\n                self._share.shareAppMessageWithGold(callBack, self._localScore , gold, self);\r\n                //self._isShareWithGold = false;\r\n            } else {\r\n                self._share.shareAppMessage(callBack);\r\n            }\r\n        }\r\n    },\r\n    /**\r\n     * \r\n     * @param {*} event \r\n     * @param {*} callBack \r\n     * 友助 复活\r\n     */\r\n    shareBtnWithRevived(event,callBack){\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            let func = function(){\r\n                self.assistLayerTwo.active = true;\r\n                let js = self.assistLayerTwo.getComponent(\"assistLayerJs\");\r\n                js.init(callBack)\r\n            }\r\n            self._share.shareAppMessageWithRevived(func);\r\n        }\r\n    },\r\n    /**\r\n     * \r\n     */\r\n    shareBtnWithAssit(event,callBack){\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            self._share.shareAppMessageWithAssit(callBack);\r\n        }   \r\n    },\r\n    /**\r\n     * 分享  \r\n     * ****此处分享是带分数分享（分数分享只有这个函数,要提前调用setScore 或 setLocalScore 函数) ******** \r\n     * \r\n     */\r\n    shareBtn(event, callBack) {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            self._localScore = self._userOperate.getLocalScore();\r\n            if (self._localScore) {\r\n                self._share.shareAppMessage(callBack, self._localScore);\r\n            } else {\r\n                self._share.shareAppMessage(callBack);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 分享 \r\n     * 分享到群，个人 都有回调\r\n     * \r\n     */\r\n    shareBtnWithUrl(event, callBack) {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            self._share.shareAppMessageWithImgUrl(callBack)\r\n            // if(self._localScore){\r\n            //     self._share.shareAppMessageWithImgUrl(callBack,self._localScore);\r\n            // }else{\r\n            //     self._share.shareAppMessageWithImgUrl(callBack);\r\n            //}\r\n        }\r\n    },\r\n    /**\r\n     * 分享 \r\n     * 分享群  拥有回调\r\n     * 分享到个人也拥有回调;\r\n     * callback 需要一个参数，callback(param1),\r\n     * param1  true/false, 判断是否为群\r\n     */\r\n    shareBtnWithGroup(event, callBack) {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            self._share.shareAppMessageForGroup(callBack)\r\n        }\r\n    },\r\n    /**\r\n     * 特殊功能 分享  shareTicket 增加次数的\r\n     * @param {*} event \r\n     * @param {*} callBack \r\n     */\r\n    shareBtnWithSpecial(event, callBack, obj) {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            self._share.shareAppMessageWithSpecial(callBack, obj)\r\n            // if(self._localScore){\r\n            //     self._share.shareAppMessageWithImgUrl(callBack,self._localScore);\r\n            // }else{\r\n            //     self._share.shareAppMessageWithImgUrl(callBack);\r\n            //}\r\n        }\r\n    },\r\n    /**\r\n     * 获取分享次数\r\n     */\r\n    getShareTicketTime() {\r\n        var times = config.shareGroupTime || 0;\r\n        return times;\r\n    },\r\n    /**\r\n     * 红包\r\n     */\r\n    hongbaoBtn() {\r\n        //红包功能未完成 需要开发后调试\r\n        // if(cc.sys.platform == cc.sys.WECHAT_GAME){\r\n        //     self.closeTouch()\r\n        //     var js = self.hongbaoWidget.getComponent('hongbaoLayer');\r\n        //     js.init(self)    \r\n        // }\r\n    },\r\n    // update (dt) {},\r\n    /**\r\n     * 比赛\r\n     */\r\n    hasMatch() {\r\n        // return self._match.hasMatch();\r\n        return match.hasMatch();\r\n    },\r\n    matchBtn() {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            // self._match.getMatchInfo(function(res) {\r\n            // match.getMatchInfo(function(res) {\r\n            //     if (res && res[\"data\"]) {\r\n            //         self.matchWidget.active = true;\r\n\r\n            //     }\r\n            // });\r\n            matchManager.showMatchRankView();\r\n        }\r\n    },\r\n    /**\r\n     * 获取真实好友排行榜\r\n     * \r\n     */\r\n    getFriendsRankBtn() {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n\r\n            if (typeof wx.getOpenDataContext != \"function\") {\r\n                self._flyText(\"微信版本过低，请升级\")\r\n                return\r\n            }\r\n\r\n            let openDataContext = wx.getOpenDataContext();\r\n            openDataContext.postMessage({\r\n                id: MSG.MessageID.ON_MSG_GET_FRIEND_RANK_OPEN,\r\n            })\r\n            self.friendRank.active = true;\r\n            var js = self.friendRank.getComponent('friendLayer');\r\n            js.initRank();\r\n        }\r\n    },\r\n    /**\r\n     * 获取下一个想要超越的好友\r\n     * \r\n     */\r\n    setNextFriendInfoBtn(){\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            \r\n            if( typeof wx.getOpenDataContext != \"function\"){\r\n                self._flyText(\"微信版本过低，请升级\")\r\n                return\r\n            }\r\n\r\n            let openDataContext = wx.getOpenDataContext();\r\n            openDataContext.postMessage({\r\n                id:MSG.MessageID.ON_MSG_GET_NEXT_PEOPLE,\r\n                openid:config.UID,\r\n            })\r\n        }\r\n    },\r\n    // /**\r\n    //  * 设置开放域 分数\r\n    //  * @param {*int} score \r\n    //  */\r\n    // setFriendsRankScore(score){\r\n\r\n    //     if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n    //          var weekScore = global.getUserDataInfoByName('weekScore');\r\n    //          if(!!!weekScore || weekScore <= score){\r\n    //             global.setUserDataInfoByName('weekScore',score);\r\n    //             var time = global.getTimestamp();\r\n    //             //key: 'timestamp';\r\n    //             var _kvData = new Array();\r\n    //             score = score + \"\";\r\n    //             time = time + \"\";\r\n    //             _kvData.push({key:'score',value:score},{key:'timestamp',value : time});\r\n    //             wx.setUserCloudStorage({\r\n    //                 KVDataList:_kvData,\r\n    //                 success:res=>{\r\n    //                     console.log(res);\r\n    //                 },\r\n    //                 fail:res=>{\r\n    //                     console.log(\"fail\",res);\r\n    //                 }\r\n    //             })\r\n    //         }\r\n    //     }        \r\n    // },\r\n\r\n    /**\r\n  * 获取真实群排行榜（微信平台维护）\r\n  * \r\n  */\r\n    getOpenDataQunRankBtn() {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n\r\n            if (typeof wx.getOpenDataContext != \"function\") {\r\n                self._flyText(\"微信版本过低，请升级\")\r\n                return\r\n            }\r\n            if (config.shareTicket) {\r\n                let openDataContext = wx.getOpenDataContext();\r\n                openDataContext.postMessage({\r\n                    id: MSG.MessageID.ON_MSG_GET_GROUP_RANK_OPEN,\r\n                    shareTicket: config.shareTicket,\r\n                })\r\n                self.friendRank.active = true;\r\n                var js = self.friendRank.getComponent('friendLayer');\r\n                js.initRank(\"true\");\r\n            } else {\r\n                self.shareBtnWithGroup();\r\n            }\r\n\r\n        }\r\n    },\r\n    /**\r\n     * \r\n     * @param {*} callback  为游戏更新分数接口\r\n     * //直接拉到控制按键就好\r\n     */\r\n    assistBtn(event){\r\n        self.myAssistWidget.active = true;\r\n        let js = self.myAssistWidget.getComponent(\"myAssistLayer\");\r\n        js.init(event);\r\n    },\r\n    /**\r\n     *  callback 为 复活回调， gold 为 复活消耗金币数\r\n     *    金币复活，分享互助 2合一接口\r\n     */\r\n    assistTwoBtn(callback,gold){\r\n        \r\n        self.myAssistWidget.active = true;\r\n        let js = self.myAssistWidget.getComponent(\"myAssistLayer\");\r\n        js.init(callback,true,gold);\r\n    },\r\n    /**\r\n     * 弃用 测试的\r\n     * 获取体力操作 使用下面的getVit(),subVit()\r\n     * \r\n     */\r\n    getVitBtn() {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            self._userOperate.getVit(function (res) {\r\n                console.log(res);\r\n                if (res.vit) {\r\n                    global.setUserDataInfoByName('vit', res.vit)\r\n                }\r\n            });\r\n\r\n        }\r\n    },\r\n    subVitBtn() {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            self._userOperate.getVit(function (res) {\r\n                console.log(res);\r\n                global.setUserDataInfoByName('vit', res.vit);\r\n                if (parseInt(res.vit) > 0) {\r\n                    self._userOperate.subVit(function (res) {\r\n                        var num = global.getUserDataInfoByName('vit');\r\n                        global.setUserDataInfoByName('vit', num - 1)\r\n                    }, 1);\r\n                } else {\r\n                    self._flyText(\"您的体力不足\");\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /* \r\n    * 飘字\r\n    */\r\n    _flyText(_text, color, strokeColor,time) {\r\n        var textNode = new cc.Node;\r\n        textNode.addComponent(cc.Label);\r\n        textNode.addComponent(cc.LabelOutline);\r\n        let winSize = self.node.getContentSize();\r\n        textNode.setContentSize(winSize.width-80,200);\r\n        var text = textNode.getComponent(cc.Label);\r\n        text.string = _text || \"\";//\"您的体力不足\";\r\n        text.fontSize = 40;\r\n        text.lineHeight = 40;\r\n        text.overflow = cc.Label.Overflow.RESIZE_HEIGHT;\r\n        textNode.color = color || cc.color(247, 255, 43, 255);\r\n        var textOutLine = textNode.getComponent(cc.LabelOutline);\r\n        textOutLine.color = strokeColor || cc.color(63, 2, 2, 255);\r\n        textOutLine.width = 2;\r\n        self.node.addChild(textNode);\r\n        var size = self.node.getContentSize();\r\n        //textNode.setPosition(size.width/2,size.height);\r\n        var fadeOut = cc.fadeOut(0.2);\r\n        var move = cc.moveBy(0.2, cc.p(0, 200));\r\n        time = time || 0.3;\r\n        textNode.runAction(cc.sequence(cc.delayTime(time), cc.spawn(fadeOut, move), cc.callFunc(function () {\r\n            textNode.destroy();\r\n        }, self)))\r\n    },\r\n    /*\r\n    *分数操作\r\n    */\r\n    getScore() {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            return self._userOperate.getScore();\r\n        }\r\n        return 0;\r\n    },\r\n    setScore(score) {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            if (typeof score == 'number') {\r\n                self._isShareWithGold = true;\r\n                self.addGameStartTimes();\r\n                self.setCurLocalScore(score);\r\n                self._userOperate.setScore(score);\r\n            }\r\n        }\r\n    },\r\n    /**\r\n     * 检查分数 是否超过分享复活的界限 ，（老玩家3次后都返回TRUE）\r\n     */\r\n    checkScore(score){\r\n        if( global.getLowScoreTimes() >= 5 ){\r\n            return true;\r\n        }\r\n\r\n        if(config.topScore <= score){\r\n            if(global.getHeightScoreTimes() >= 2 ){\r\n                return true;\r\n            }else{\r\n                global.setHeightScoreTimes()\r\n            }\r\n            \r\n        }else{\r\n            global.setLowScoreTimes();\r\n        } \r\n        return false;\r\n    },\r\n    /**\r\n     * 设置本次分享分数\r\n     * @param {*} score \r\n     */\r\n    setCurLocalScore(score) {\r\n        if (typeof score == 'number') {\r\n            self._userOperate.setLocalScore(score);\r\n        }\r\n    },\r\n    /* \r\n    *体力操作\r\n    */\r\n    getVit() {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            global.setUserDataInfoByName('vit', res.vit);\r\n        }\r\n        return 0;\r\n    },\r\n    subVit(callBack) {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            self._userOperate.getVit(function (res) {\r\n                global.setUserDataInfoByName('vit', res.vit);\r\n                if (parseInt(res.vit) > 0) {\r\n                    self._userOperate.subVit(function (res) {\r\n                        var num = global.getUserDataInfoByName('vit');\r\n                        global.setUserDataInfoByName('vit', num - 1);\r\n                        if (callBack && typeof callBack == 'function') {\r\n                            callBack();\r\n                        }\r\n\r\n                    }, 1);\r\n                } else {\r\n                    self._flyText(\"您的体力不足\");\r\n                }\r\n            });\r\n\r\n        }\r\n    },\r\n    /**\r\n     * \r\n     * 设置用户自定义数据上传\r\n     */\r\n    setCustomData(blob, callBack) {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            self._userOperate.setBlob(blob, callBack);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 金币/积分 操作\r\n     */\r\n    getGold() {\r\n        let gold = consume.getGold();\r\n        return gold;\r\n    },\r\n    /**\r\n     * \r\n     * @param {*} _num \r\n     * @param {*} callBack  带一个参数 (true/false 判断消耗金币 成功/失败);\r\n     */\r\n    subGold(_num,callBack) {\r\n        consume.subGold( _num,callBack);\r\n    },\r\n    addGold( _num) {\r\n        consume.addGold( _num );\r\n    },\r\n    /*\r\n    *打开 体力定时器 30分钟恢复一次体力；\r\n    */\r\n    openVitTimers() {\r\n        self.schedule(self.callback, 1800);\r\n    },\r\n    onDestroy() {\r\n        self.unschedule(self.callback);\r\n    },\r\n\r\n    /**\r\n     * 开奖操作\r\n     */\r\n    startActivity(callBack) {\r\n        lottery.startActivity(callBack);\r\n    },\r\n\r\n    runLottery(type, callBack) {\r\n        lottery.runLottery(type, callBack);\r\n    },\r\n\r\n    quitActivity(callBack) {\r\n        lottery.quitActivity(callBack);\r\n    },\r\n\r\n    //保存公众号;\r\n    saveOfficalAccount() {\r\n        var node=cc.find(\"Canvas/officalAccount\");\r\n        if(node==null){\r\n            preview.officalAccLoad();\r\n        }else{\r\n            node.active=true;\r\n        }\r\n    },\r\n    \r\n    //更多预览\r\n    moreGame() {\r\n        preview.previewImage();\r\n    },\r\n    //显隐公众号\r\n    officalAccActive(show) {\r\n        var node = cc.find(\"Canvas/officalBtn\");\r\n        if (node == null && show) {\r\n            preview.loadRes();\r\n        } else if (node == null & !show) {\r\n            return;\r\n        } else {\r\n            node.active = show;\r\n        }\r\n    },\r\n    /**\r\n     * 添加 游戏开始次数 \r\n     */\r\n    addGameStartTimes(){\r\n        global.addStartGameTimes();\r\n    },\r\n    /**\r\n     * 获得 游戏开始次数\r\n     */\r\n    getGameStartTimes(){\r\n        return global.getStartGameTimes();\r\n    }\r\n});\r\n\r\n"]}